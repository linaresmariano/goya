extends ../layout

block content
	link(rel='stylesheet', href='/stylesheets/fullcalendar/fullcalendar.css')
	link(rel='stylesheet', href='/stylesheets/fullcalendar/fullcalendar.print.css',media='print')
	div(ng-controller='CalendarCtrl')
		.row
			.col-md-2.col-md-2
					div
						div#menu-courses(class="panel panel-default size-menu ")
							div.panel-heading Horarios de cursos
								button.btn.btn-default.btn-xs.pull-right
									span.glyphicon.glyphicon-search
							.size-menu-height
								div(ng-repeat="courseNotAssigned in infoCoursesNotAssigned track by $index")
									div(data-target='#myModal',data-toggle='modal',ng-click='showCoursesNotAssigned($index)',class="dragg-course list-group-item",draggable-course,dragg-model="courseNotAssigned"){{courseNotAssigned.schedule.courses[0].subject.nick}} {{courseNotAssigned.schedule.type}} {{getCommissions(courseNotAssigned.schedule)}}
						div(class="panel panel-default size-menu ")
							div.panel-heading Aulas
								button.btn.btn-default.btn-xs.pull-right
									span.glyphicon.glyphicon-search
							.size-menu-height
								div(style="position:relative",ng-repeat="classRoom in classRooms track by $index")
									div.dragg-class-room.size-menu(ng-model="classRoom",dragg-class-room).list-group-item {{classRoom.number}}
						div(class="panel panel-default size-menu ")
							div.panel-heading Profesores
								button.btn.btn-default.btn-xs.pull-right
									span.glyphicon.glyphicon-search
							.size-menu-height
								div.scroll-menu(style="position:relative",ng-repeat="teacher in teachers track by $index")
									div(data-target='#modal-teacher',data-toggle='modal',class="list-group-item size-menu",class="dragg-teacher ",dragg-teacher,ng-model="teacher"){{teacher.name}}
										span(ng-init="teacher.hasCurrentSemesterTeachers=hasCurrentSemesterTeachers(teacher)",ng-if="!teacher.hasCurrentSemesterTeachers",ng-model="teacher.hasCurrentSemesterTeachers")
											span(class="pull-right glyphicon glyphicon-warning-sign notify-danger",title="Este profesor no fue asignado a ningun curso") 
			.col-md-10.col-md-10
					div
						.calendar(ng-model='eventSources', calendar='myCalendar', config='uiConfig.calendar', ui-calendar='uiConfig.calendar', id='grid')
		//Modal de cursos 
		#myModal.modal.fade(tabindex='-1', role='dialog', aria-labelledby='myModalLabel', aria-hidden='true')
			.modal-dialog
				.modal-content
					.modal-header.header-color-blue
						button.close(type='button', data-dismiss='modal')
							span(aria-hidden='true') ×
							span.sr-only Close
						h4#myModalLabel.modal-title {{scheduleShow ? scheduleShow.schedule.courses[0].subject.name : ''}} - {{scheduleShow ?  scheduleShow.schedule.type : ''}}  {{ scheduleShow ? getCommissions(scheduleShow.schedule) : ''}}
					.modal-body 
						.row.list-group
							div.list-group-item 
								b Editar
								button.btn.btn-xs.btn-info.pull-right.button-option
									span.glyphicon.glyphicon-edit
						.row.list-group
							div.list-group-item 
								b Aula
								&nbsp; {{scheduleShow.schedule.semesterClassRoom.classRoom.number}}
								button.btn.btn-xs.btn-danger.pull-right(type="button",ng-click="deallocateClassroom()")
										span.glyphicon.glyphicon-remove
						.row.list-group
							div.list-group-item 
								b Ocultar
									input.pull-right(type="checkbox")
						.row.panel.panel-default
							.panel-heading Profesores a cargo del curso
							div.list-group-item(ng-repeat="semesterTeacher in getTeachers(scheduleShow.schedule.courses) track by $index")
								div{{semesterTeacher.teacher.name}} 
									button.btn.btn-xs.btn-danger.pull-right(type="button",ng-click="deallocateCourseTeacher(semesterTeacher.teacher.id,semesterTeacher)")
										span.glyphicon.glyphicon-remove
						.row.panel.panel-default
							.panel-heading Profesores no a cargo del curso
							div.list-group-item(ng-repeat="semesterTeacher in getInstructors(scheduleShow.schedule.courses) track by $index")
								div	{{semesterTeacher.teacher.name}}
									button.btn.btn-xs.btn-danger.pull-right(type="button",ng-click="deallocateCourseInstructor(semesterTeacher.teacher.id,semesterTeacher)")
										span.glyphicon.glyphicon-remove
						.row.panel.panel-default
							.panel-heading Profesores asignados a este horario
							div.list-group-item(ng-repeat="semesterTeacher in scheduleShow.schedule.semesterTeachers track by $index")
								div	{{semesterTeacher.teacher.name}}
									button.btn.btn-xs.btn-danger.pull-right(type="button",ng-click="deallocateScheduleTeacher(semesterTeacher.teacher.id,$index)")
										span.glyphicon.glyphicon-remove
									button.btn.btn-xs.btn-default.pull-right.button-option(type="button",ng-click="hideTeacher(semesterTeacher.teacher)")
										div(ng-if="!isHideTeacher(semesterTeacher.teacher)")
											span.glyphicon.glyphicon-eye-close
										div(ng-if="isHideTeacher(semesterTeacher.teacher)")
											span.glyphicon.glyphicon-eye-open
						.row.panel.panel-default
							.panel-heading  Opciones avanzadas	- Solo aplican en la grilla
									button.btn.btn-xs.btn-default.pull-right(type="button")
										span.glyphicon.glyphicon-plus
							row
								.content-row
									form(ng-submit="updatePatch()")
										.col-lg-6
											.form-group
												label(for='extraHour') Horario de inicio extra
												input#extraHour.form-control(type="number",ng-model="newPatchExtras.extraHour",ng-value="scheduleShow.schedule.patch.extraHour",step="0.5", name="extraHour")
										.col-lg-6
											.form-group
												label(for='extraDuration') Horas de duracion extra
												input#extraDuration.form-control(type="number",ng-model="newPatchExtras.extraDuration",ng-value="scheduleShow.schedule.patch.extraDuration",step="0.5", name="extraDuration")
											button.pull-right.padding-bottom-button(type="submit",class="btn btn-success") Guardar
					.modal-footer
						button.btn.btn-default(type='button', data-dismiss='modal') Cancelar
						button.btn.btn-danger(type='button',ng-click="remove()",ng-show='hasSchedule()') Eliminar
						
		//Modal para asignar un profesor a un curso
		#assingTeacherCourse.modal.fade(tabindex='-1', role='dialog', aria-labelledby='myModalLabel', aria-hidden='true')
			.modal-dialog(ng-init="isInCharge=1")
				.modal-content
					.modal-header.header-color-blue
						button.close(type='button', data-dismiss='modal')
							span(aria-hidden='true') ×
							span.sr-only Close
						h4#myModalLabel.modal-title ¿Como deseas asignar a este profesor?
					.modal-body 
						row.form-control
							.col-lg-4
								div Profesor a cargo
									input.pull-right(ng-model="isInCharge",type="radio",value="0")
							.col-lg-4
								div Profesor no a cargo
									input.pull-right(ng-model="isInCharge",type="radio",value="1")
					.modal-footer
						button.btn.btn-default(type='button', data-dismiss='modal') Cancelar
						button.btn.btn-primary(type='button',ng-click="assignedTeacherToCourse(isInCharge)") Aceptar
						
	script(src='/js/lib/jquery.printThis.js')
	button.btn.btn-primary.pull-right(onclick="$('#grid').css('width', '100%');$('#grid').width($('#grid').width());$('#grid').printThis()") Imprimir grilla
	script(src='/js/lib/jquery.ui.droppable.js')
	script(src='/js/fullcalendar/fullcalendar.js')
	script.
		var semesterJSON=!{JSON.stringify(semester)};
		$(window).resize(function () {
			$("#grid").css("width", "100%");
			$("#grid").width($("#grid").width());
		});
	script(src='/js/calendarioAcademico/academicCalendar.js')
